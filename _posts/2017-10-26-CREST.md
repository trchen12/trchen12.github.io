---
layout: post
title: ICCV 论文：CREST
data: 2017-10-26
header-img: "img/6.jpg"
categories: blog
description: Markdown tutorial
---

# ICCV2017:Convolutional Residual Learning for Visual Tracking

  昨天刚刚聊过一篇EBT，提到现在的Tracking没有发挥最大的end2end效果，今天读到ICCV17的一篇CREST号称*“Our method integrates feature extraction, response map generation as well as model up- date into the neural networks for an end-to-end training”*.实验部分还没来得及看，不过该工作的主要方法还是挺不错的。

## Introduction

其实现在做tracking的很多结合相关滤波的工作，本文上来就举例DCFs，不过也指出了DCFs方法的问题：learn the filters **separately** from feature extraction, and up- date these filters using a moving average operation with an empirical weight. 其实这也是该文的出发点之一，如何把feature extraction ,response map generation 以及model update 搞到一个end2end的网络里一起给训练了，当然了，据论文说，现在的DCFs除了上面的原因，还有一些缺点像利用经验插值来更新模型能否平衡好稳定性和适用性的问题，于是作者提了如下的问题（当然也给出了解答）

- 能不能搞成一个end2end的模型
- 能不能有更有效的方法来更新模型

**当然本文也给出了相应的方法和结论。**

- 将相关滤波等效成一个卷积层，将feature extraction， response generation, 和model update 都放进一个CNN里面train
- 利用残差学习，在时空域中，来捕获一个target的变化，有助于减缓剧烈变化带来的计算难度。
- 当然在一些数据集上达到了state-of-the-art。

## Convolutional Residual Learing


### DCFs Reformulation
之前没有介绍过相关滤波的方法，不过似乎是傅里叶域下解决的。为了把相关滤波的工作做进CNN，这里用到了一个非常好的性质：**在傅里叶域的乘积，等于在时域的卷积**，于是乎一波公式推导，将DCFs等效成了一个卷积层+L2 loss这样一个目标函数，这样卷积层的权重就很快通过一些SGD的方法可以确定。记得以前学傅里叶变换的时候，觉得卷积定理实在是有趣，通过域的变换可以简化很多计算，也得到了很多有趣的性质。而在卷积神经网络横行的今天，直觉上想到卷积定理，也就很合理了。也是看到end2end的tracking，才注意这篇文章，而这个卷积定理的应用，实在是妙哈哈哈.对KCF感兴趣的同学请走这里 [KCF](https://zhuanlan.zhihu.com/p/26685032)


### Residual Learning

将之前等效的结果称为base layer, 然后引入了残差学习来搞base layer和ground truth的差。大概就是H = B + R 的变换。和resnet的shortcut结构类似，而残差学习能有效的对base layer的output以及ground truth的差进行建模，减缓了一些噪声的影响，对剧烈变化也具有更高的鲁棒性。

**到这里，这篇paper的核心novelty就差不多说完了。关于一些如response map，DCFs的知识后面有时间我再补充吧。**

## Tracking via CREST


### Model Initialization
给一帧带有target location的输入，从target里提取一些patches用来训练，这些patch也被用来特征提取（VGG），获取response map.其他的像base layer residual layer的参数都采用0均值高斯分布的方法随机初始化。
### Online detection
让当前帧往前传，得到一个response map，我们可以通过最大化response value的方式来locate到目标（具体参考论文公式）。
### Scale Estimation
从目标的中心位置开始，以不同尺度进行采样，然后将不同尺度的patch重新resize到一个固定的size，这个size和训练的patch.size()是相同的。论文还给了一个坐标的变换公式，这里就不多介绍了。
### Model Update
其实在tracking的时候，一直会产生可以用来训练的patches.每一帧得到预测的目标之后，我们都可以产生很多相应的ground truth, 然后和新产生了patches可以组成训练对给模型训练。（这里可能理解有误，贴上原文For each frame, after predicting the tar- get location we can generate the corresponding ground truth response map, and the search patch can be directly adopted as the training patch. The collected training patches and re- sponse maps from every T frames are adopted as training pairs which will be fed into our network for online update.）

## Experiments
我没细看哈哈哈哈我就是这么懒。在自己的paper里，结果根本不会输给别人。不论是不是真的达到了state-of-the-art还是故事讲得好，这种end2end的CNN做tracking的思路还是蛮好的。那个卷积定理真的秒啊，加上resnet的加持，中ICCV的确是问题不大。今天就说这么多吧，实在是不想贴公式贴图片。。


